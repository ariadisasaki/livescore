<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Live Score PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#0f172a;
  --card:#1e293b;
  --text:white;
}

.light{
  --bg:#f1f5f9;
  --card:white;
  --text:#111;
}

body{
  font-family:Segoe UI;
  background:var(--bg);
  color:var(--text);
  margin:0;
  padding:15px;
  transition:0.3s;
}

h1{text-align:center;}

.topbar{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-bottom:15px;
  flex-wrap:wrap;
}

button{
  padding:8px 15px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

.match{
  background:var(--card);
  padding:15px;
  border-radius:15px;
  margin-bottom:15px;
  box-shadow:0 5px 15px rgba(0,0,0,0.3);
  transition:0.3s;
}

.favorite{
  border:2px solid gold;
}

.goalFlash{
  animation:flash 0.6s alternate 6;
}

@keyframes flash{
  from{background:#14532d;}
  to{background:var(--card);}
}

.teams{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.team{text-align:center;width:35%;}
.team img{height:45px;}

.score{
  font-size:28px;
  font-weight:bold;
  width:30%;
  text-align:center;
}

.league{
  font-size:13px;
  margin-bottom:8px;
  display:flex;
  align-items:center;
  gap:5px;
}

.league img{height:16px;}

.status{
  text-align:center;
  margin-top:5px;
  font-size:13px;
  color:#22c55e;
}
</style>
</head>
<body>

<h1>‚öΩ LIVE SCORE PRO</h1>

<div class="topbar">
  <button onclick="toggleTheme()">üåó Mode</button>
  <button onclick="enableNotif()">üîî Notifikasi</button>
</div>

<div id="matches">Loading...</div>

<script>
const API_KEY="9658cfc38277a5c1b3a4af706ae2d77d";
const PREMIER_LEAGUE_ID=39; // ID liga EPL
let previousScores={};

async function getMatches(){
  try{
    const res=await fetch(`https://v3.football.api-sports.io/fixtures?live=all&league=${PREMIER_LEAGUE_ID}`,{
      headers:{"x-apisports-key":API_KEY}
    });

    const data=await res.json();
    if(!data.response || data.response.length===0){
      document.getElementById("matches").innerHTML="Tidak ada match EPL live.";
      return;
    }

    let html="";
    data.response.forEach(match=>{
      let id=match.fixture.id;
      let score=`${match.goals.home}-${match.goals.away}`;

      let flash="";
      if(previousScores[id] && previousScores[id]!==score){
        flash="goalFlash";
        sendGoalNotif(match);
      }

      previousScores[id]=score;

      html+=`
      <div class="match ${flash}" id="match-${id}">
        <div class="league">
          <img src="${match.league.logo}">
          <img src="${match.league.flag}">
          ${match.league.name}
        </div>

        <div class="teams">
          <div class="team">
            <img src="${match.teams.home.logo}">
            <div>${match.teams.home.name}</div>
          </div>

          <div class="score">
            ${match.goals.home??0} - ${match.goals.away??0}
          </div>

          <div class="team">
            <img src="${match.teams.away.logo}">
            <div>${match.teams.away.name}</div>
          </div>
        </div>

        <div class="status">
          ${match.fixture.status.short} ${match.fixture.status.elapsed??""}'
        </div>

        <div style="text-align:center;margin-top:8px;">
          <button onclick="toggleFav(${id})">‚≠ê Favorit</button>
        </div>
      </div>
      `;
    });

    document.getElementById("matches").innerHTML=html;

    loadFavorites();

  }catch(e){
    document.getElementById("matches").innerHTML="Error ambil data.";
  }
}

function toggleFav(id){
  let fav=JSON.parse(localStorage.getItem("favMatches")||"[]");
  if(fav.includes(id)){
    fav=fav.filter(x=>x!==id);
  }else{
    fav.push(id);
  }
  localStorage.setItem("favMatches",JSON.stringify(fav));
  loadFavorites();
}

function loadFavorites(){
  let fav=JSON.parse(localStorage.getItem("favMatches")||"[]");
  fav.forEach(id=>{
    let el=document.getElementById("match-"+id);
    if(el) el.classList.add("favorite");
  });
}

function sendGoalNotif(match){
  if(Notification.permission==="granted"){
    new Notification("‚öΩ GOL!",{
      body:`${match.teams.home.name} ${match.goals.home} - ${match.goals.away} ${match.teams.away.name}`
    });
  }
}

function enableNotif(){
  Notification.requestPermission();
}

function toggleTheme(){
  document.body.classList.toggle("light");
}

getMatches();
setInterval(getMatches,20000);
</script>

</body>
</html>
